# üîí AN√ÅLISE COMPLETA DE SEGURAN√áA - TODAS AS ROTAS BACKEND

**Data**: Janeiro 2025
**Branch**: `feature/subscription-modules`
**Arquivos Analisados**: 16 arquivos de rotas

---

## üìä RESUMO EXECUTIVO

### **Estat√≠sticas da An√°lise**
- **Total de Arquivos de Rotas**: 16
- **Rotas que PRECISAM prote√ß√£o `requireProPlan`**: 8 arquivos (50%)
- **Rotas SEM prote√ß√£o adequada**: 45+ rotas individuais
- **Gravidade**: üî¥ **CR√çTICA**

---

## üéØ CLASSIFICA√á√ÉO DAS ROTAS

### **CATEGORIA A: PLANO PRO - PRECISAM `requireProPlan`** üî¥

| Arquivo | Feature | N¬∫ Rotas | Status Atual | Prioridade |
|---------|---------|----------|--------------|------------|
| `programRoutes.js` | Biblioteca de Programas | 15 | ‚ùå SEM PROTE√á√ÉO | üî¥ CR√çTICA |
| `assignmentRoutes.js` | Atribui√ß√£o de Programas | 10 | ‚ùå SEM PROTE√á√ÉO | üî¥ CR√çTICA |
| `promptLevelRoutes.js` | N√≠veis de Prompting | 3 | ‚ùå SEM PROTE√á√ÉO | üî¥ CR√çTICA |
| `reportRoutes.js` | Relat√≥rios de Evolu√ß√£o | 4 | ‚ùå SEM PROTE√á√ÉO | üî¥ ALTA |
| `caseDiscussionRoutes.js` | Discuss√µes de Caso | 2 | ‚ùå SEM PROTE√á√ÉO | üî¥ ALTA |
| `parentChatRoutes.js` | Chat com Pais | 2 | ‚ùå SEM PROTE√á√ÉO | üî¥ ALTA |
| `contactRoutes.js` | Contatos Profissionais | 2 | ‚ö†Ô∏è PARCIAL | üü° M√âDIA |
| `parentRoutes.js` | Dashboard de Pais | 1 | ‚ö†Ô∏è PARCIAL | üü° M√âDIA |

### **CATEGORIA B: AMBOS OS PLANOS - OK SEM PROTE√á√ÉO** ‚úÖ

| Arquivo | Feature | Status |
|---------|---------|--------|
| `adminRoutes.js` | Gest√£o Admin | ‚úÖ OK (apenas admin role) |
| `schedulingRoutes.js` | Agendamento | ‚úÖ OK (recurso scheduling) |
| `recurringAppointmentRoutes.js` | Agendamentos Recorrentes | ‚úÖ OK (recurso scheduling) |
| `therapistScheduleRoutes.js` | Agenda Pessoal | ‚úÖ OK (recurso scheduling) |
| `authRoutes.js` | Autentica√ß√£o | ‚úÖ OK (p√∫blico/auth) |
| `subscriptionRoutes.js` | Assinaturas | ‚úÖ OK (super admin) |
| `superAdminRoutes.js` | Super Admin | ‚úÖ OK (super admin) |
| `notificationRoutes.js` | Notifica√ß√µes | ‚úÖ OK (ambos) |

### **CATEGORIA C: CASOS ESPECIAIS** ‚ö†Ô∏è

| Arquivo | Regra Especial | A√ß√£o Necess√°ria |
|---------|----------------|-----------------|
| `patientRoutes.js` | Edi√ß√£o de dados expandidos | ‚ö†Ô∏è Apenas PUT `/patients/:id/expanded` precisa `requireProPlan` |

---

## üî¥ DETALHAMENTO DAS ROTAS QUE PRECISAM PROTE√á√ÉO

### **1. programRoutes.js** - üî¥ CR√çTICO

**Feature**: Biblioteca de Programas ABA (Pro)

#### **Rotas SEM Prote√ß√£o (15)**:
```javascript
// ‚ùå TODAS ESTAS ROTAS PRECISAM DE requireProPlan:

// Programas globais (super admin) - OK como est√°
router.post('/global', verifySuperAdmin, ...); // ‚úÖ OK
router.get('/global', verifySuperAdmin, ...); // ‚úÖ OK
router.put('/global/:id', verifySuperAdmin, ...); // ‚úÖ OK
router.delete('/global/:id', verifySuperAdmin, ...); // ‚úÖ OK

// Programas customizados - PRECISAM PROTE√á√ÉO
router.get('/hierarchy', ...); // ‚ùå Hierarquia de disciplinas
router.post('/custom', ...); // ‚ùå Criar programa customizado
router.get('/custom', ...); // ‚ùå Buscar programas customizados
router.put('/custom/:id', ...); // ‚ùå Atualizar programa customizado
router.delete('/custom/:id', ...); // ‚ùå Deletar programa customizado

// Programas gerais - PRECISAM PROTE√á√ÉO
router.post('/', ...); // ‚ùå Criar programa
router.get('/', ...); // ‚ùå Listar todos os programas
router.get('/:id', ...); // ‚ùå Detalhes de programa
router.put('/:id', ...); // ‚ùå Atualizar programa
router.delete('/:id', ...); // ‚ùå Deletar programa

// Programas de pacientes - PRECISAM PROTE√á√ÉO
router.get('/patient/:patientId/grade', ...); // ‚ùå Grade de programas do paciente
router.get('/:id/usage', ...); // ‚ùå Estat√≠sticas de uso
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// programRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Aplicar em TODAS as rotas (exceto /global que √© super admin):
router.get('/hierarchy', requireProPlan, programController.getDisciplineHierarchy);
router.post('/custom', requireProPlan, programController.createCustomProgram);
router.get('/custom', requireProPlan, programController.getCustomPrograms);
router.put('/custom/:id', requireProPlan, programController.updateCustomProgram);
router.delete('/custom/:id', requireProPlan, programController.deleteCustomProgram);
router.post('/', requireProPlan, programController.createProgram);
router.get('/', requireProPlan, programController.getAllPrograms);
router.get('/patient/:patientId/grade', requireProPlan, programController.getPatientProgramsGrade);
router.get('/:id/usage', requireProPlan, programController.getProgramUsage);
router.get('/:id', requireProPlan, programController.getProgramDetails);
router.put('/:id', requireProPlan, programController.updateProgram);
router.delete('/:id', requireProPlan, programController.deleteProgram);
```

---

### **2. assignmentRoutes.js** - üî¥ CR√çTICO

**Feature**: Atribui√ß√£o de Programas a Pacientes (Pro)

#### **Rotas SEM Prote√ß√£o (10)**:
```javascript
// ‚ùå TODAS PRECISAM DE requireProPlan:
router.get('/prompt-levels', ...); // ‚ùå N√≠veis de prompting dispon√≠veis
router.post('/progress', ...); // ‚ùå Registrar progresso detalhado
router.post('/', ...); // ‚ùå Atribuir programa
router.delete('/:assignmentId', ...); // ‚ùå Remover atribui√ß√£o
router.get('/patient/:patientId', ...); // ‚ùå Programas do paciente
router.get('/:id', ...); // ‚ùå Detalhes de atribui√ß√£o
router.get('/:id/history', ...); // ‚ùå Hist√≥rico (incluindo arquivados)
router.patch('/:id/status', ...); // ‚ùå Atualizar status
router.get('/:assignmentId/progress', ...); // ‚ùå Evolu√ß√£o
router.put('/:assignmentId/custom-trials', ...); // ‚ùå Tentativas customizadas
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// assignmentRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Aplicar em TODAS as rotas:
router.get('/prompt-levels', requireProPlan, assignmentController.getPromptLevels);
router.post('/progress', requireProPlan, assignmentController.recordProgress);
router.post('/', requireProPlan, assignmentController.assignProgramToPatient);
router.delete('/:assignmentId', requireProPlan, assignmentController.removeProgramFromPatient);
router.get('/patient/:patientId', requireProPlan, assignmentController.getAssignedProgramsByPatientId);
router.get('/:id', requireProPlan, assignmentController.getAssignmentDetails);
router.get('/:id/history', requireProPlan, assignmentController.getAssignmentDetailsWithHistory);
router.patch('/:id/status', requireProPlan, assignmentController.updateAssignmentStatus);
router.get('/:assignmentId/progress', requireProPlan, assignmentController.getEvolutionForAssignment);
router.put('/:assignmentId/custom-trials', requireProPlan, assignmentController.updateCustomTrials);
```

---

### **3. promptLevelRoutes.js** - üî¥ CR√çTICO

**Feature**: Gest√£o de N√≠veis de Prompting (Pro)

#### **Rotas SEM Prote√ß√£o (3)**:
```javascript
// ‚ùå TODAS PRECISAM DE requireProPlan:
router.put('/assignment/:assignmentId', ...); // ‚ùå Atualizar prompt level
router.get('/assignment/:assignmentId', ...); // ‚ùå Buscar prompt level
router.get('/patient/:patientId/program/:programId', ...); // ‚ùå Prompt level por programa
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// promptLevelRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Aplicar depois de verifyToken:
router.use(verifyToken);
router.use(requireProPlan); // ‚úÖ Aplica em todas as rotas do arquivo

// Ou individualmente:
router.put('/assignment/:assignmentId', requireProPlan, promptLevelController.updatePromptLevel);
router.get('/assignment/:assignmentId', requireProPlan, promptLevelController.getCurrentPromptLevel);
router.get('/patient/:patientId/program/:programId', requireProPlan, promptLevelController.getPromptLevelByPatientAndProgram);
```

---

### **4. reportRoutes.js** - üî¥ ALTA

**Feature**: Relat√≥rios de Evolu√ß√£o com IA (Pro)

#### **Rotas SEM Prote√ß√£o (4)**:
```javascript
// ‚ùå TODAS PRECISAM DE requireProPlan:
router.get('/evolution-data/:patientId', ...); // ‚ùå Dados de evolu√ß√£o
router.put('/professional-data', ...); // ‚ùå Atualizar dados profissionais
router.put('/patient-data/:patientId', ...); // ‚ùå Atualizar dados complementares
router.get('/automatic-analysis/:patientId', ...); // ‚ùå An√°lise autom√°tica
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// reportRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Aplicar depois de verifyToken:
router.use(verifyToken);
router.use(requireProPlan); // ‚úÖ Aplica em todas as rotas

// Ou individualmente:
router.get('/evolution-data/:patientId', requireProPlan, reportController.getEvolutionReportData);
router.put('/professional-data', requireProPlan, reportController.updateProfessionalData);
router.put('/patient-data/:patientId', requireProPlan, reportController.updatePatientData);
router.get('/automatic-analysis/:patientId', requireProPlan, reportController.getAutomaticAnalysis);
```

---

### **5. caseDiscussionRoutes.js** - üî¥ ALTA

**Feature**: Discuss√µes de Caso entre Terapeutas (Pro)

#### **Rotas SEM Prote√ß√£o (2)**:
```javascript
// ‚ùå PRECISAM DE requireProPlan:
router.get('/patient/:patientId', verifyToken, ...); // ‚ùå Buscar mensagens
router.post('/patient/:patientId', verifyToken, ...); // ‚ùå Criar mensagem
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// caseDiscussionRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

router.get('/patient/:patientId', verifyToken, requireProPlan, caseDiscussionController.getMessagesByPatient);
router.post('/patient/:patientId', verifyToken, requireProPlan, caseDiscussionController.createMessage);
```

---

### **6. parentChatRoutes.js** - üî¥ ALTA

**Feature**: Chat entre Pais e Terapeutas (Pro)

#### **Rotas SEM Prote√ß√£o (2)**:
```javascript
// ‚ùå PRECISAM DE requireProPlan:
router.get('/:patientId', verifyToken, ...); // ‚ùå Buscar mensagens
router.post('/:patientId', verifyToken, ...); // ‚ùå Postar mensagem
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// parentChatRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

router.get('/:patientId', verifyToken, requireProPlan, parentChatController.getMessages);
router.post('/:patientId', verifyToken, requireProPlan, parentChatController.postMessage);
```

---

### **7. contactRoutes.js** - ‚ö†Ô∏è PARCIAL

**Feature**: Contatos de Terapeutas e Colegas

#### **An√°lise**:
- `GET /therapists/:patientId` - Usado por pais (pode ser Pro ou Scheduling se houver pais)
- `GET /colleagues/:patientId` - Usado para discuss√µes de caso (Pro apenas)

#### **Corre√ß√£o Necess√°ria**:
```javascript
// contactRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Apenas /colleagues precisa prote√ß√£o (discuss√µes de caso = Pro)
router.get('/therapists/:patientId', verifyToken, contactController.getTherapistContacts); // ‚úÖ OK
router.get('/colleagues/:patientId', verifyToken, requireProPlan, contactController.getColleagueContacts); // ‚ùå ADICIONAR
```

---

### **8. parentRoutes.js** - ‚ö†Ô∏è PARCIAL

**Feature**: Dashboard de Pais

#### **An√°lise**:
- Dashboard de pais mostra evolu√ß√£o de programas (Pro)
- Pais existem apenas em plano Pro (chat, acompanhamento)

#### **Corre√ß√£o Necess√°ria**:
```javascript
// parentRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

router.get('/dashboard', verifyToken, requireProPlan, parentController.getDashboardData);
```

---

### **9. patientRoutes.js** - ‚ö†Ô∏è CASO ESPECIAL

**Feature**: Gest√£o de Pacientes

#### **An√°lise**:
- Leitura de pacientes: Ambos os planos ‚úÖ
- Edi√ß√£o de dados b√°sicos: Ambos os planos ‚úÖ
- **Edi√ß√£o de dados expandidos**: Apenas Pro ‚ùå

#### **Rotas Atuais**:
```javascript
router.get('/', verifyToken, ...); // ‚úÖ OK - ambos
router.get('/:id', verifyToken, ...); // ‚úÖ OK - ambos
router.patch('/:patientId/notes', verifyToken, ...); // ‚úÖ OK - ambos
router.get('/:id/expanded', verifyToken, ...); // ‚ö†Ô∏è Leitura - OK (dados existentes)
router.put('/:id/expanded', verifyToken, ...); // ‚ùå Edi√ß√£o - PRECISA requireProPlan
```

#### **Corre√ß√£o Necess√°ria**:
```javascript
// patientRoutes.js
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Apenas PUT /expanded precisa prote√ß√£o:
router.put('/:id/expanded', verifyToken, requireProPlan, [...valida√ß√µes], patientController.updatePatientExpandedData);

// GET /expanded pode ficar sem (permite visualizar dados antigos ao fazer downgrade)
router.get('/:id/expanded', verifyToken, patientController.getPatientExpandedData); // ‚úÖ OK
```

---

## üìä RESUMO DAS CORRE√á√ïES NECESS√ÅRIAS

### **Total de Rotas a Proteger**: 45+

| Arquivo | Rotas a Proteger | M√©todo |
|---------|------------------|--------|
| `programRoutes.js` | 15 rotas | Individual ou `router.use()` ap√≥s imports |
| `assignmentRoutes.js` | 10 rotas | Individual ou `router.use()` |
| `promptLevelRoutes.js` | 3 rotas | `router.use(requireProPlan)` ap√≥s `verifyToken` |
| `reportRoutes.js` | 4 rotas | `router.use(requireProPlan)` ap√≥s `verifyToken` |
| `caseDiscussionRoutes.js` | 2 rotas | Individual (adicionar ap√≥s `verifyToken`) |
| `parentChatRoutes.js` | 2 rotas | Individual (adicionar ap√≥s `verifyToken`) |
| `contactRoutes.js` | 1 rota | Individual (`/colleagues` apenas) |
| `parentRoutes.js` | 1 rota | Individual |
| `patientRoutes.js` | 1 rota | Individual (`PUT /expanded` apenas) |

---

## üõ°Ô∏è ESTRAT√âGIAS DE IMPLEMENTA√á√ÉO

### **Op√ß√£o 1: router.use() - Mais R√°pido** ‚ö°
Quando TODAS as rotas do arquivo precisam prote√ß√£o:

```javascript
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

router.use(verifyToken);
router.use(requireProPlan); // ‚úÖ Aplica em todas as rotas abaixo

// Todas as rotas agora exigem Pro
router.get('/', ...);
router.post('/', ...);
```

**Arquivos que podem usar**: `promptLevelRoutes.js`, `reportRoutes.js`

---

### **Op√ß√£o 2: Individual - Mais Preciso** üéØ
Quando apenas algumas rotas precisam prote√ß√£o:

```javascript
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Protegidas
router.get('/colleagues/:patientId', verifyToken, requireProPlan, ...);

// Livres
router.get('/therapists/:patientId', verifyToken, ...);
```

**Arquivos que precisam**: `contactRoutes.js`, `parentRoutes.js`, `patientRoutes.js`

---

### **Op√ß√£o 3: Mista - Mais Organizada** üìã
Quando h√° muitas rotas, mas nem todas precisam:

```javascript
const { requireProPlan } = require('../middleware/subscriptionMiddleware');

// Rotas p√∫blicas/scheduling
router.get('/public', ...);

// A partir daqui, todas precisam Pro
router.use(requireProPlan);

router.get('/pro-feature-1', ...);
router.post('/pro-feature-2', ...);
```

**Arquivos que podem usar**: `programRoutes.js` (exceto `/global`), `assignmentRoutes.js`

---

## ‚ö†Ô∏è IMPACTO DA N√ÉO-IMPLEMENTA√á√ÉO

### **Riscos de Seguran√ßa** üî¥

#### **1. Burla Completa do Sistema de Planos**
```bash
# Usu√°rio com plano scheduling pode:
curl -H "Authorization: Bearer TOKEN_SCHEDULING" \
  http://api.abaplay.com/api/programs

# ‚ùå RESULTADO: Acessa biblioteca completa de programas
```

#### **2. Cria√ß√£o de Dados Pro em Plano Scheduling**
```bash
# Pode atribuir programas:
curl -X POST -H "Authorization: Bearer TOKEN_SCHEDULING" \
  -d '{"patient_id": 1, "program_id": 10}' \
  http://api.abaplay.com/api/assignments

# ‚ùå RESULTADO: Cria atribui√ß√µes (feature Pro) sem pagar
```

#### **3. Acesso a Features Pagas Sem Autoriza√ß√£o**
- Chat com pais ‚ùå
- Discuss√µes de caso ‚ùå
- Relat√≥rios de evolu√ß√£o ‚ùå
- Dashboard anal√≠tico ‚ùå
- N√≠veis de prompting ‚ùå

### **Impacto Financeiro** üí∞
- Cl√≠nicas usando features Pro sem pagar
- Perda de receita estimada: **100% do diferencial entre planos**
- Diferen√ßa de pre√ßo: R$ 25,00/paciente (R$ 10 ‚Üí R$ 35)

---

## ‚úÖ CHECKLIST DE IMPLEMENTA√á√ÉO

### **Fase 0: Prote√ß√£o Backend (URGENTE)**

```
[ ] 1. Criar arquivo de teste para validar prote√ß√µes
[ ] 2. programRoutes.js (15 rotas)
[ ] 3. assignmentRoutes.js (10 rotas)
[ ] 4. promptLevelRoutes.js (3 rotas)
[ ] 5. reportRoutes.js (4 rotas)
[ ] 6. caseDiscussionRoutes.js (2 rotas)
[ ] 7. parentChatRoutes.js (2 rotas)
[ ] 8. contactRoutes.js (1 rota - /colleagues)
[ ] 9. parentRoutes.js (1 rota - /dashboard)
[ ] 10. patientRoutes.js (1 rota - PUT /expanded)
[ ] 11. Testar com Postman/curl cada rota protegida
[ ] 12. Validar mensagens de erro 403
[ ] 13. Testar com trial ativo (deve funcionar como Pro)
[ ] 14. Documentar altera√ß√µes no CLAUDE.md
```

---

## üß™ SCRIPT DE TESTE

Criar arquivo `backend/tests/subscription-security.test.js`:

```javascript
/**
 * Testes de seguran√ßa de assinatura
 * Valida que rotas Pro est√£o protegidas
 */

const request = require('supertest');
const app = require('../src/server');

describe('Prote√ß√£o de Rotas Pro', () => {
  let schedulingToken, proToken;

  beforeAll(async () => {
    // Login com usu√°rio scheduling
    const resScheduling = await request(app)
      .post('/api/auth/login')
      .send({ username: 'scheduling.user', password: 'test' });
    schedulingToken = resScheduling.body.token;

    // Login com usu√°rio pro
    const resPro = await request(app)
      .post('/api/auth/login')
      .send({ username: 'pro.user', password: 'test' });
    proToken = resPro.body.token;
  });

  describe('Programas - Biblioteca Pro', () => {
    it('deve bloquear acesso de scheduling a /api/programs', async () => {
      const res = await request(app)
        .get('/api/programs')
        .set('Authorization', `Bearer ${schedulingToken}`);

      expect(res.status).toBe(403);
      expect(res.body.error).toContain('plano Pro');
      expect(res.body.requiresPro).toBe(true);
    });

    it('deve permitir acesso de pro a /api/programs', async () => {
      const res = await request(app)
        .get('/api/programs')
        .set('Authorization', `Bearer ${proToken}`);

      expect(res.status).toBe(200);
      expect(res.body).toHaveProperty('programs');
    });
  });

  describe('Atribui√ß√µes - Feature Pro', () => {
    it('deve bloquear POST /api/assignments de scheduling', async () => {
      const res = await request(app)
        .post('/api/assignments')
        .set('Authorization', `Bearer ${schedulingToken}`)
        .send({ patient_id: 1, program_id: 1 });

      expect(res.status).toBe(403);
    });
  });

  // ... Adicionar testes para todas as 45 rotas
});
```

---

## üìÑ C√ìDIGO PRONTO PARA IMPLEMENTA√á√ÉO

### **Template de Prote√ß√£o**

```javascript
// [ARQUIVO].js
const express = require('express');
const router = express.Router();
const { verifyToken } = require('../middleware/authMiddleware');
const { requireProPlan } = require('../middleware/subscriptionMiddleware'); // ‚úÖ ADICIONAR
const controller = require('../controllers/[CONTROLLER]');

// ==========================================
// ESTRAT√âGIA 1: Proteger todas as rotas
// ==========================================
router.use(verifyToken);
router.use(requireProPlan); // ‚úÖ Todas as rotas abaixo exigem Pro

router.get('/', controller.getAll);
router.post('/', controller.create);
// ...

// ==========================================
// ESTRAT√âGIA 2: Proteger individualmente
// ==========================================
router.use(verifyToken);

// Rota protegida
router.get('/pro-feature', requireProPlan, controller.proFeature);

// Rota livre
router.get('/free-feature', controller.freeFeature);

module.exports = router;
```

---

## üéØ PRIORIZA√á√ÉO FINAL

### **üî¥ URGENTE (Fazer HOJE)**
1. `programRoutes.js` - Biblioteca de programas
2. `assignmentRoutes.js` - Atribui√ß√µes
3. `promptLevelRoutes.js` - N√≠veis de prompting

### **üü† ALTA (Fazer esta semana)**
4. `reportRoutes.js` - Relat√≥rios
5. `caseDiscussionRoutes.js` - Discuss√µes
6. `parentChatRoutes.js` - Chat com pais

### **üü° M√âDIA (Fazer em seguida)**
7. `contactRoutes.js` - Contatos (/colleagues)
8. `parentRoutes.js` - Dashboard de pais
9. `patientRoutes.js` - Edi√ß√£o expandida

---

## üìû CONCLUS√ÉO

### **Status Atual**: üî¥ **SISTEMA INSEGURO**

**45+ rotas de features Pro est√£o COMPLETAMENTE DESPROTEGIDAS no backend.**

Qualquer usu√°rio com plano scheduling pode:
- ‚úÖ Fazer requisi√ß√µes diretas via API
- ‚úÖ Acessar biblioteca de programas
- ‚úÖ Atribuir programas a pacientes
- ‚úÖ Registrar sess√µes detalhadas
- ‚úÖ Gerar relat√≥rios de evolu√ß√£o
- ‚úÖ Usar chat com pais
- ‚úÖ Criar discuss√µes de caso

**Bloqueio apenas no frontend N√ÉO √â SEGURAN√áA.**

### **A√ß√£o Imediata Necess√°ria**:
Implementar prote√ß√£o `requireProPlan` em TODAS as rotas Pro antes de qualquer deploy.

---

**Pr√≥ximo Passo**: Atualizar `GUIA_FINALIZACAO_MODULOS.md` com Fase 0 detalhada.

**Tempo Estimado de Implementa√ß√£o**: 4-6 horas para todas as 45 rotas + testes.
